{% extends "base.html" %}

{% block content %}


    <h1 align="center"> Alle Touren auf einen Blick </h1>

    <!-- Alle Touren werden angezeigt -->

    <div class="col-10 mx-auto">

        <div class="row">
            <h2 class="col-8"> Startpunkte der Touren</h2>
            <button onclick="ermittlePosition()" class="col-4">Position ermitteln</button>
        </div>

        <div id="mapdiv" style="height:400px; width:100%;">&nbsp;</div>       

        <br/>

        <br/>

        <div class="row">
            

            {% for t in touren %}
            
                <div class="card bg-dark text-white col-lg-4 col-md-6 p-3 border bg-light">
                    <div class="card-header">
                        <h3>Tour Titel</h3>
                    </div>
                    <img class="card-img" src="./../static/vorschaubilder/{{ touren[t] }}" alt="Card image">
                    <div class="card-footer">
                        <a href="/testRoute" class="btn btn-primary stretched-link">Mehr Details</a>
                    </div>
                </div>

            {% endfor %}

        </div>

    </div>

    

{% endblock %}

{% block scripts %}
<script src="http://www.openlayers.org/api/OpenLayers.js"></script>
<script>
    map = new OpenLayers.Map("mapdiv");
    map.addLayer(new OpenLayers.Layer.OSM());

    /*if (navigator.geolocation) {
        
        var lonLat = new OpenLayers.LonLat( navigator.geolocation.getCurrentPosition.coords.longitude, navigator.geolocation.getCurrentPosition.coords.latitude )
          .transform(
            new OpenLayers.Projection("EPSG:4326"), // transform from WGS 1984
            map.getProjectionObject() // to Spherical Mercator Projection
          );
    } else { */
        var lonLat = new OpenLayers.LonLat( 8.5166646, 52.0166666 )
          .transform(
            new OpenLayers.Projection("EPSG:4326"), // transform from WGS 1984
            map.getProjectionObject() // to Spherical Mercator Projection
          );
    
    /*    }*/

    

          var zoom=15;

    var markers = new OpenLayers.Layer.Markers( "Markers" );
    map.addLayer(markers);
    map.setCenter (lonLat, zoom);
    var size = new OpenLayers.Size(25,25);
    var offset = new OpenLayers.Pixel(-(size.w/2), -size.h);
  

    
    /* einzelne Markierungen setzen */
    {% for k in koordinaten %}

        var lonLat_{{ k }} = new OpenLayers.LonLat( {{ koordinaten[k][0] }}, {{ koordinaten[k][1] }} )
            .transform(new OpenLayers.Projection("EPSG:4326"), map.getProjectionObject()   );
        var {{ k }} = new OpenLayers.Marker( lonLat_{{ k }} );
        {{ k }}.events.register("click", map, function(e) { location.href = "/testRoute"  });
        markers.addMarker({{ k }});


    {% endfor %}


    
    

 

function ermittlePosition() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(zeigePosition);
    } else { 
        ausgabe.innerHTML = 'Ihr Browser unterstützt keine Geolocation.';
    }
}

function zeigePosition(position) {
    ausgabe.innerHTML = "Ihre Koordinaten sind:<br> Breite: " + position.coords.latitude + 
    "<br>Länge: " + position.coords.longitude;	
}
    
</script>


{% endblock %}